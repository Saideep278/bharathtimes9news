{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-aFq/bzH65dt+w6FI2ooMVUpc+21e0SRygnTpmBvdBgSdnuTN7QbdgL+OapgHtvPp" crossorigin="anonymous">
  <!-- from yt source -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
    integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
    crossorigin="anonymous"></script>

  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <link rel="icon" href="{% static 'images/brand.jpeg' %}">
  <!-- from yt source -->
  <title>BHARATHTIMES9 Latest news and updates for India</title>
  <style>
    #btnone{
      background-image: url("{% static 'images/politics.jpg' %}");
      background-repeat: no-repeat;
      background-size: 100% 100%;
      width: 350px;
      height: 350px;
      transition: transform 250ms ease-in-out;
    }
    #btnone:hover{
      box-shadow: 10px 20px 20px #0000002e;
      filter: brightness(100%);
      transform: scale(1.08);
      transform-origin: center;
    }
    #btntwo{
      background-image: url("{% static 'images/sports.jpg' %}");
      background-repeat: no-repeat;
      background-size: 100% 100%;
      width: 350px;
      height: 350px;
      transition: transform 250ms ease-in-out;
    }
    #btntwo:hover{
      box-shadow: 10px 20px 20px #0000002e;
      filter: brightness(100%);
      transform: scale(1.08);
      transform-origin: center;
    }
    #btnthree{
      background-image: url("{% static 'images/business.jpeg' %}");
      background-repeat: no-repeat;
      background-size: 100% 100%;
      width: 350px;
      height: 350px;
      transition: transform 250ms ease-in-out;
    }
    #btnthree:hover{
      box-shadow: 10px 20px 20px #0000002e;
      filter: brightness(100%);
      transform: scale(1.08);
      transform-origin: center;
    }
    .btn{
      background: black;
    }
    .ta {
      text-decoration: none;
      color: black;
    }
    .img {
      display: inline;
      height: 70px;
      width: 90px;
      border-radius: 8px;
      transition: transform 250ms ease-in-out;
    }

    .img:hover {
      box-shadow: 10px 20px 20px #0000002e;
      filter: brightness(100%);
      transform: scale(1.08);
      transform-origin: center;
    }

    .not-visible {
      display: none;
    }

    .desc {
      display: inline;
    }
  </style>
</head>

<body>

  <nav class="navbar navbar-expand-md bg-dark  ">
    <a href="{% url 'home' %}" class=" navbar-brand fs-3 ms-3 text-white "><img class="rounded-circle"
        src="{% static '/images/brand.jpeg' %}" height="70" width="70"></a>
    <button class="navbar-toggler me-3 text-white " type="button" data-bs-toggle="collapse" data-bs-target="#btnnav">
      <i class='bx bx-menu bx-md'></i>
    </button>
    <div class="collapse navbar-collapse" id="btnnav">
      <ul class="navbar-nav ms-auto ">
        
          
        <li class="nav-item p-2">
          <div class="load-more__btn mt-1" id="nav_pol">
            <button type="button" class="btn btn-lg text-white bg-dark ">Politics</button>
          </div>
        </li>
        <li class="nav-item p-2">
          <div class="load-more__btn mt-1" id="nav_spo">
            <button type="button" class="btn btn-lg text-white bg-dark">Sports</button>
          </div>
        </li>
        <li class="nav-item p-2">
          <div class="load-more__btn mt-1" id="nav_bus">
            <button type="button" class="btn btn-lg text-white bg-dark">Business</button>
          </div>
        </li>
        <li class="nav-item p-2">
          <div class="load-more__btn mt-1" id="nav_ent">
            <button type="button" class="btn btn-lg text-white bg-dark">Entertainment</button>
          </div>
        </li>
        <li class="nav-item p-2">
          <div class="load-more__btn mt-1" id="nav_cri">
            <button type="button" class="btn btn-lg text-white bg-dark">Crime</button>
          </div>
        </li>
        <li class="nav-item p-2">
          <div class="load-more__btn mt-1" id="nav_int">
            <button type="button" class="btn btn-lg text-white bg-dark">International</button>
          </div>
        </li>

      </ul>

    </div>
  </nav>

  <nav class="navbar navbar-expand-md bg-dark ">
    <a href="{% url 'home' %}" class=" navbar-brand fs-3 ms-3 text-white "> <b>BHARATHTIMES9</b> </a>
    <button class="navbar-toggler me-3 text-white " type="button" data-bs-toggle="collapse" data-bs-target="#btnnavv">
      <i class='bx bx-menu bx-md'></i>
    </button>
    <div class="collapse navbar-collapse p-2" id="btnnavv">
      <ul class="navbar-nav ms-auto  ">
        <form method="get" action="{% url 'loadSearch' %}" class="d-flex">
          {% csrf_token %}
          <input name="query" id="query" class="form-control me-2" type="search" placeholder="Search"
            aria-label="Search" c>
          <button class="btn btn-outline-success" type="submit"> 
            <svg xmlns="http://www.w3.org/2000/svg" width="16"
              height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
              <path
                d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
            </svg>
           </button>
        </form>
      </ul>
    </div>
  </nav>




  <div class="bg-dark text-white">
    <marquee scrollamount="10" class="marq">
      {% for i in context %}
      {{i.tagline}}
      {% endfor%}
    </marquee>
  </div>

  <br>
  <div class="container p-3 shadow-lg bg-light ">
    <div class="row p-3">
      <div class="col">
        <div class="container">
          <h1 id="category_change"><b>Breaking News</b></h1>
          <div class="content" id="content">
            {% for i in context %}
            <div class="single_content border border-light mt-2 pl-2">
              <a class="ta" href="{{i.id}}">
                <h2> {{ i.title }} </h2>
              </a>
              <a href="{{i.id}}"><img class="img" src="{{i.media.url}}"></a>
              <p class="desc"> {{ i.tagline }} </p>
            </div>
            {% endfor %}
          </div>
          <br>
          <div class="spinner-border text-primary mt-2 not-visible" role="status" id="spinner">
            <span class="sr-only"></span>
          </div>
          <div class="load-more__btn mt-3" id="btn">
            <button type="button" class="btn btn-success">Load More</button>
          </div>
          <div class="alert alert-danger mt-2 not-visible" role="alert" id='alert'>
            No more post to load!!
          </div>
        </div>
      </div>
      <div class="col ">
        <div class="container">
          <h1><b>BHARATHTIMES 9</b></h1>
          <h1><b></b>EXCLUSIVE </b></h1>
        </div>
      </div>
    </div>
    <br><br>
    <div class="row p-3">
      <div class="col">
        <div class="load-more__btn mt-3" id="politics_btn">
          <button type="button" id="btnone" class="btn btn-lg rounded btn-success text-black "></button>
        </div>
      </div>
      <div class="col">
        <div class="load-more__btn mt-3" id="sports_btn">
          <button type="button" id="btntwo" class="btn btn-lg rounded btn-success"></button>
        </div>
      </div>
      <div class="col">
        <div class="load-more__btn mt-3" id="business_btn">
          <button type="button" id="btnthree" class="btn btn-lg rounded btn-success"></button>
        </div>
      </div>
    </div>
  </div>
  <br>
  <div class="container p-3 shadow-lg bg-light ">
    <div class="row p-3 ">
      <div class="col">

      </div>
      <div class="col">

      </div>
      <div class="col">

      </div>
    </div>
    <div class="row p-3 ">
      <div class="col ">
        <div class="container">
          <a href="{% url 'about' %}" class="ta p-5"><b>About</b></a>
        </div>
      </div>
      <div class="col">
        <div class="container">
          <a href="{% url 'contact' %}" class="ta p-5"><b>Contact</b></a>
        </div>
      </div>
      <div class="col">
        <div class="container">
          <a href="{% url 'help' %}" class="ta p-5"><b>Help</b></a>
        </div>
      </div>
    </div>
  </div>
  <br><br><br>
  {{total_obj|json_script:"json-total"}}

  <script>

    const nav_pol = document.getElementById('nav_pol');
    const nav_spo = document.getElementById('nav_spo');
    const nav_bus = document.getElementById('nav_bus');
    const nav_ent = document.getElementById('nav_ent');
    const nav_cri = document.getElementById('nav_cri');
    const nav_int = document.getElementById('nav_int');


    const ssportsBtn = document.getElementById('sports_btn');
    const politicsBtn = document.getElementById('politics_btn');
    const businessBtn = document.getElementById('business_btn');

    const loadBtn = document.getElementById('btn');
    const spinner = document.getElementById('spinner');
    const total = JSON.parse(document.getElementById('json-total').textContent);
    const alert = document.getElementById('alert');



    function loadmorePost() {
      var _current_item = $('.single_content').length
      const content_container = document.getElementById('content')
      $.ajax({
        url: '{% url "load" %}',
        type: 'GET',
        data: {
          'total_item': _current_item
        },
        beforeSend: function () {
          loadBtn.classList.add('not-visible');
          spinner.classList.remove('not-visible');
        },
        success: function (response) {
          const data = response.posts
          spinner.classList.add('not-visible');

          data.map(i => {
            var temp = "abcd/"
            temp = temp + i.media
            console.log(i.media);

            content_container.innerHTML += `<div class="single_content border border-light mt-2 pl-2">
                                              <h2> ${i.title} </h2>
                                              <a href="${i.id}"> <img class="img" src=" ${temp} "></a>
                                              <p class="desc">  ${i.tagline}  </p>
                                              </div>`
          });
          if (_current_item == total) {
            alert.classList.remove('not-visible');
          } else {
            loadBtn.classList.remove('not-visible');
          }


        },
        error: function (err) {
          console.log(err);
        }
      })
    }

    function loadCategory(param) {
      const content_container = document.getElementById('content')
      const category_change = document.getElementById('category_change')
      const dept_param = param.toUpperCase()
      $.ajax({
        url: param,
        type: 'GET',
        success: function (response) {
          const data = response.news
          category_change.innerHTML = `<h1 id="category_change" ><b> ${dept_param} </b></h1>`
          content_container.innerHTML = `<div class="single_content border border-light mt-2 pl-2">
                                              
                                              </div>`
          data.map(i => {
            var temp = "abcd/"
            temp = temp + i.media


            content_container.innerHTML += `<div class="single_content border border-light mt-2 pl-2">
                                              <h2> ${i.title} </h2>
                                              <a href="${i.id}"> <img class="img" src=" ${temp} "></a>
                                              <p class="desc">  ${i.tagline}  </p>
                                              </div>`
          });

          loadBtn.classList.add('not-visible');
          alert.classList.add('not-visible');
        },
        error: function (err) { console.log("HII"); }
      })
    };


    loadBtn.addEventListener('click', () => {
      loadmorePost();
    });

    ssportsBtn.addEventListener('click', () => {
      loadCategory("sports");
    });

    politicsBtn.addEventListener('click', () => {
      loadCategory("politics");
    });

    businessBtn.addEventListener('click', () => {
      loadCategory("business");
    });

    nav_pol.addEventListener('click', () => {
      loadCategory("politics");
    });

    nav_spo.addEventListener('click', () => {
      loadCategory("sports");
    });

    nav_bus.addEventListener('click', () => {
      loadCategory("business");
    });

    nav_ent.addEventListener('click', () => {
      loadCategory("entertainment");
    });

    nav_cri.addEventListener('click', () => {
      loadCategory("crime");
    });

    nav_int.addEventListener('click', () => {
      loadCategory("international");
    });
    

  </script>
</body>

</html>